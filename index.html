<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>CSS Performances</title>
    <meta name="viewport" content="initial-scale=1">
    <link href="http://fonts.googleapis.com/css?family=Source+Sans+Pro:400,700|Source+Code+Pro" rel="stylesheet">
    <link href="stylesheets/presentation.css" rel="stylesheet">
    <link href="stylesheets/print.css" rel="stylesheet" media="print">
</head>
<body>
<article>


    <section>
        <div class="content content--card">
            <h1>
                Les performances de rendu
                <span class="big">CSS</span>
            </h1>
            <small class="classy">15 min pour comprendre les enjeux !</small>
        </div>
    </section>


    <section>
        <div class="content">
            <h2>Pourquoi les performances CSS ?</h2>
            <div class="content__main">
                <p>Pour obtenir des interactions fluides</p>
                <ul>
                    <li>Défilement <em>(scroll)</em></li>
                    <li>Transition et animation CSS</li>
                    <li>Manipulation du contenu</li>
                </ul>
            </div>
        </div>
    </section>


    <section>
        <div class="content">
            <h2>Pourquoi les performances CSS ?</h2>
            <div class="content__main">
                <p>Pour l'image, l'immersion  et l'accessibilité !</p>
                
                <p>Parce que le rendu était trop lent, ils ont diminué l'ombre dans leur design.</p>
                <cite>&mdash; airbnb,
                    <a href="http://nerds.airbnb.com/box-shadows-are-expensive-to-paint/">
                        bit.ly/airbnb-shadow
                    </a>
                </cite>
                
                <p>Le rendu CSS est l'un des trois principaux facteurs de lenteurs JavaScript.</p>
                <cite>&mdash; Opera,
                    <a href="https://dev.opera.com/articles/efficient-javascript/?page=3#reflow">
                        bit.ly/opera-css-perfs
                    </a>
                </cite>
            </div>
        </div>
    </section>


    <section>
        <div class="content">
            <h2>Pourquoi les performances CSS ?</h2>
            <div class="content__main">
                <p>
                    Ne pas faire de transition ou d'animation CSS
                    avec une autre propriété que
                </p>
                <ul>
                    <li><code>opacity</code></li>
                    <li><code>transform</code><br>
                        <small><em>(translation, rotation, redimensionnement, ...)</em></small>
                    </li>
                    <li><code>filter</code><br>
                        <small><em>(flou, luminosité, contraste, niveau de gris, ...)</em></small>
                    </li>
                </ul>
            </div>
        </div>
        <div class="img-corner">
            <img width="300" src="images/marteau.png" />
            <img  width="300" src="images/clou.png" />
        </div>
    </section>


    <section>
        <div class="content">
            <h2>Pourquoi les performances CSS ?</h2>
            <div class="content__main">
                <p>
                    On va essayer de diminuer la zone "boîte noire"
                </p>
                <img src="images/navigateur1.svg" />
            </div>
        </div>
    </section>


    <section>
        <div class="content">
            <h2>Pourquoi les performances CSS ?</h2>
            <div class="content__main">
                <p>
                    Ne pas faire de transition ou d'animation CSS
                    avec une autre propriété que
                </p>
                <ul>
                    <li><code>opacity</code></li>
                    <li><code>transform</code></li>
                    <li><code>filter</code></li>
                </ul>
            </div>
        </div>
        <div class="img-corner">
            <img width="300" src="images/marteau.png" />
            <img style="transform: translateY(35%)" width="300" src="images/clou.png" />
        </div>
    </section>


    <section>
        <div class="content content--card">
            <h1>Thomas Zilliox</h1>
            <small class="classy">Développeur freelance</small>
            <div>Expert CSS : maintenabilité et performance</div>
        </div>
    </section>


    <section>
        <div class="content content--card">
            <h1>Comment les navigateurs</h1>
            <small class="classy">passent</small>
            <div>du CSS aux pixels</div>
        </div>
    </section>


    <section>
        <div class="content">
            <h2>Du CSS aux pixels</h2>
            <div class="content__main">
                <p>
                    Les navigateurs web ont, <em>à peu près,</em><br>
                    deux fils d'exécution pour le rendu
                </p>
                <ul>
                    <li>Le principal <em>(Main)</em></li>
                    <li>Celui de composition <em>(Compositor)</em></li>
                </ul>
                <cite>&mdash; Adobe,
                    <a href="http://blogs.adobe.com/webplatform/2014/03/18/css-animations-and-transitions-performance/">
                        bit.ly/inside-the-browser
                    </a>
                </cite>
            </div>
        </div>
    </section>


    <section>
        <div class="content">
            <h2>Du CSS aux pixels</h2>
            <div class="content__main">
                <p>
                    Le fil principal se charge de
                </p>
                <ul>
                    <li>Calculer les règles CSS</li>
                    <li>La mise en page <em>(Layout / Reflow)</em></li>
                    <li>Calculer chaque pixels <em>(Painting / Draw)</em></li>
                </ul>
                <img src="images/navigateur2.svg" />
                <cite>&mdash; Ilya Grigorik,
                    <a href="https://hpbn.co/primer-on-web-performance/">bit.ly/process-pipeline</a>
                </cite>
            </div>
        </div>
    </section>


    <section>
        <div class="content">
            <h2>Du CSS aux pixels</h2>
            <div class="content__main">
                <p>
                    Le fil de composition se charge principalement de dessiner les pixels sur l'écran
                </p>
                <img src="images/navigateur2c.svg" />
            </div>
        </div>
    </section>


    <section>
        <div class="content content--card">
            <h1>
                Objectif
                <span class="big">16ms</span>
            </h1>
        </div>
    </section>


    <section>
        <div class="content">
            <h2>Objectif 16ms</h2>
            <div class="content__main">
                <p>
                    Chaque frame doit prendre maximum 16ms pour garder une fréquence d'images à 60fps
                </p>
                <video  muted loop controls>
                    <source src="videos/framerate-light.mp4" type="video/mp4">
                </video>
                <cite>&mdash; Youtube,
                    <a href="https://www.youtube.com/watch?v=pfiHFqnPLZ4">youtu.be/pfiHFqnPLZ4</a>
                </cite>
            </div>
        </div>
    </section>


    <section>
        <div class="content">
            <h2>Objectif 16ms</h2>
            <div class="content__main">
                <p>Le premier rendu d'un élément</p>
                <img src="images/NavigateurAnim1.svg" />
            </div>
        </div>
    </section>


    <section>
        <div class="content">
            <h2>Objectif 16ms</h2>
            <div class="content__main">
                <p>Lorsqu'on anime la largeur d'un élément, on déclenche un re-layout</p>
                <img src="images/NavigateurAnim2.svg" />
                <p>
                    Aucune autre action utilisateur n'est possible pendant la mise en page.
                </p>
                <cite>&mdash; Google,
                    <a href="https://developers.google.com/speed/articles/reflow">bit.ly/layout-engine</a>
                </cite>
            </div>
        </div>
    </section>


    <section>
        <div class="content">
            <h2>Objectif 16ms</h2>
            <div class="content__main">
                <p>Lorsqu'on anime une transformation sur un élément, on reste dans la composition</p>
                <img src="images/NavigateurAnim3.svg" />
                <cite>&mdash; Paul Lewis (Google),
                    <a href="https://csstriggers.com/">https://csstriggers.com</a>
                </cite>
            </div>
        </div>
    </section>


    <section>
        <div class="content">
            <h2>Objectif 16ms</h2>
            <div class="content__main">
                <p>
                    Ne pas faire de transition ou d'animation CSS
                    avec une autre propriété que
                </p>
                <ul>
                    <li><code>opacity</code></li>
                    <li><code>transform</code></li>
                    <li><code>filter</code></li>
                </ul>
            </div>
        </div>
        <div class="img-corner">
            <img width="300" src="images/marteau.png" />
            <img style="transform: translateY(60%)" width="300" src="images/clou.png" />
        </div>
    </section>


    <section>
        <div class="content content--card">
            <h1>Des outils</h1>
            <small class="classy">pour</small>
            <div>Investiguer</div>
        </div>
    </section>


    <section>
        <div class="content">
            <h2>Des outils pour investiguer</h2>
            <div class="content__main">
                <img src="images/navigateur3.svg" />
                <p>Détecter les reflows (Console de Firefox)</p>
                <video  muted loop controls>
                    <source src="videos/reflow-micro.mp4" type="video/mp4">
                </video>
            </div>
        </div>
    </section>


    <section>
        <div class="content">
            <h2>Des outils pour investiguer</h2>
            <div class="content__main">
                <img src="images/navigateur3b.svg" />
                <p>Détecter les repaints (Console de Chrome)</p>
                <video  muted loop controls>
                    <source src="videos/repaint.mp4" type="video/mp4">
                </video>
            </div>
        </div>
    </section>


    <section>
        <div class="content">
            <h2>Des outils pour investiguer</h2>
            <div class="content__main">
                <img src="images/navigateur3b.svg" />
                <p>Investiguer les repaints (Timeline de Chrome)</p>
                <img src="images/paint.png" />
            </div>
        </div>
    </section>


    <section>
        <div class="content">
            <h2>Des outils pour investiguer</h2>
            <div class="content__main">
                <img src="images/navigateur3b.svg" />
                <p>Les éléments fixes sont redessinés au défilement </p>
                <video  muted loop controls>
                    <source src="videos/repaint-fixed.mp4" type="video/mp4">
                </video>
            </div>
        </div>
    </section>


    <section>
        <div class="content content--card">
            <h1>Des retours d'expériences</h1>
        </div>
    </section>


    <section>
        <div class="content">
            <h2>Des retours d'expériences</h2>
            <div class="content__main">
                <p>Vous pouvez créer un nouveau layer en appliquant <code>perspective(1px)</code>*</p>
                <video  muted loop controls>
                    <source src="videos/repaint-translateZ.mp4" type="video/mp4">
                </video>
                <p>* Attention quand même aux hacks magiques !</p>
            </div>
        </div>
    </section>


    <section>
        <div class="content">
            <h2>Des retours d'expériences</h2>
            <div class="content__main">
                <p>Si vous avez une image de fond fixe au défilement</p>
                <ul>
                    <li>Séparer l'image sur un élément à part</li>
                    <li>Créer un nouveau layer pour cet élément</li>
                </ul>
                <cite>&mdash; Four Kitchens,
                    <a href="https://www.fourkitchens.com/blog/article/fix-scrolling-performance-css-will-change-property">
                        http://bit.ly/bg-fixed-perfs
                    </a>
                </cite>
            </div>
        </div>
    </section>


    <section>
        <div class="content">
            <h2>Des retours d'expériences</h2>
            <div class="content__main">
                <p>Pour animer l'ajout d'une ombre sur un élément</p>
                <ul>
                    <li>Séparer l'ombre sur un élément à part</li>
                    <li>Animer l'opacité de cet élément</li>
                </ul>
                <img src="images/box-shadow.gif" />
                <cite>&mdash; Tobias Ahlin,
                    <a href="http://tobiasahlin.com/blog/how-to-animate-box-shadow/">
                        http://bit.ly/animate-shadow
                    </a>
                </cite>
            </div>
        </div>
    </section>


    <section>
        <div class="content content--card">
            <h1>Conclusion</h1>
        </div>
    </section>


    <section>
        <div class="content">
            <h2>Conclusion</h2>
            <div class="content__main">
                <p>
                    Ne pas faire de transition ou d'animation CSS
                    avec une autre propriété que
                </p>
                <ul>
                    <li><code>opacity</code></li>
                    <li><code>transform</code></li>
                    <li><code>filter</code></li>
                </ul>
            </div>
        </div>
        <div class="img-corner">
            <img width="300" src="images/marteau.png" />
            <img style="transform: translateY(80%)" width="300" src="images/clou.png" />
        </div>
    </section>


    <section>
        <div class="content content--card">
            <h1>Merci ;)</h1>
            <div>tzi.fr ou @iamtzi</div>
        </div>
    </section>


    <section>
        <div class="content">
            <h2>Visualiser le reflow</h2>
            <div class="content__main">
                <img src="images/navigateur3.svg" />
                <video muted controls>
                    <source src="videos/reflow.mp4" type="video/mp4">
                </video>
                <cite>&mdash; CSSReflow (Mozilla),
                    <a href="http://pixeln3rd.github.io/cssreflow/">bit.ly/cssreflow</a>
                </cite>
            </div>
        </div>
    </section>


    <section>
        <div class="content">
            <h2>Les sources du reflow</h2>
            <div class="content__main">
                <img src="images/navigateur3.svg" />
                <p>
                    Elle est déclanchée par
                </p>
                <ul>
                    <li>Modification du DOM, dont le contenu</li>
                    <li>Prise de mesure<br>
                        <small>(<code>offsetHeight</code> ou <code>getComputedStyle</code>)</small>
                    </li>
                    <li>Modification de l'attribut class</li>
                    <li>Modification des styles CSS</li>
                    <li>Le redimenssionnement de la fenêtre</li>
                    <li>Le scroll</li>
                </ul>
            </div>
        </div>
    </section>


    <section>
        <div class="content">
            <h2>Les retours d'expérience</h2>
            <div class="content__main">
                <p>Créer un nouveau layer</p>
                <ul>
                    <li><code>translateZ(0)</code></li>
                    <li><code>perspective(1px)</code></li>
                    <li><code>will-change</code>*</li>
                </ul>
                <p>* Mais attention <code>will-change</code> <em>will</em> change</p>
                <cite>&mdash; GreenSock, <a href="http://greensock.com/will-change">greensock.com/will-change</a></cite>
            </div>
        </div>
    </section>

    
</article>
<script src="javascripts/bespoke.min.js"></script>
<script src="javascripts/bespoke-classes.min.js"></script>
<script src="javascripts/bespoke-keys.min.js"></script>
<script src="javascripts/bespoke-touch.min.js"></script>
<script src="javascripts/bespoke-hash.min.js"></script>
<script src="javascripts/bespoke-slidenumber.min.js"></script>
<script src="javascripts/presentation.js"></script>
</body>
</html>
